{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "1abcea64_2dc7e1a6",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/filter/HealthCheckStatusFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 52,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2024-12-09T16:05:27Z",
      "side": 1,
      "message": "`listenUrl` is optional as per documentation [1], can you include the documented default here?\n\nAlso, we could have multiple values configured:\n\n```\nIf multiple values are supplied, the daemon will listen to all of them.\n```\n\nThis should arguably be a `getStringList` and some logic (or at least warnings) should be added to deal with multiple values.\n\n\n[1] https://gerrit-review.googlesource.com/Documentation/config-gerrit.html#httpd.listenUrl",
      "revId": "2127e7067c6c2d8377f76af9cdd4349aa5b59d13",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ba41be5b_77257a15",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/filter/HealthCheckStatusFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 52,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2024-12-11T10:28:24Z",
      "side": 1,
      "message": "Hm...it looks like using multiple listenUrls is broken (master branch). I get an injection error:\n\n```\n[2024-12-11T11:22:52.077+01:00] [main] INFO  org.eclipse.jetty.server.session : node0 Scavenging every 600000ms\nDec 11, 2024 11:22:52 AM com.google.inject.servlet.InternalServletModule$BackwardsCompatibleServletContextProvider get\nWARNING: You are attempting to use a deprecated API (specifically, attempting to @Inject ServletContext inside an eagerly created singleton. While we allow this for backwards compatibility, be warned that this MAY have unexpected behavior if you have more than one injector (with ServletModule) running in the same JVM. Please consult the Guice documentation at https://github.com/google/guice/wiki/Servlets for more information.\n[2024-12-11T11:22:52.092+01:00] [main] INFO  org.eclipse.jetty.server.session : node0 Stopped scavenging\n[2024-12-11T11:22:52.094+01:00] [main] ERROR com.google.gerrit.pgm.Daemon : Unable to start daemon\njava.lang.IllegalStateException: Cannot start HTTP daemon\n\tat com.google.gerrit.pgm.http.jetty.JettyServer$Lifecycle.start(JettyServer.java:111)\n\tat com.google.gerrit.lifecycle.LifecycleManager.start(LifecycleManager.java:95)\n\tat com.google.gerrit.pgm.Daemon.start(Daemon.java:409)\n\tat com.google.gerrit.pgm.Daemon.run(Daemon.java:302)\n\tat com.google.gerrit.pgm.util.AbstractProgram.main(AbstractProgram.java:62)\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:569)\n\tat com.google.gerrit.launcher.GerritLauncher.invokeProgram(GerritLauncher.java:251)\n\tat com.google.gerrit.launcher.GerritLauncher.mainImpl(GerritLauncher.java:147)\n\tat com.google.gerrit.launcher.GerritLauncher.main(GerritLauncher.java:92)\n\tat Main.main(Main.java:30)\nCaused by: com.google.inject.ProvisionException: Unable to provision, see the following errors:\n\n1) [Guice/NullInjectedIntoNonNullable]: null returned by binding at InternalServletModule.configure(InternalServletModule.java:98) (installed by: RequestContextFilter$1 -\u003e InternalServletModule)\n but the 4th parameter context of ProjectQoSFilter.\u003cinit\u003e(ProjectQoSFilter.java:147) is not @Nullable\n  at InternalServletModule.configure(InternalServletModule.java:98)\n      \\_ installed by: RequestContextFilter$1 -\u003e InternalServletModule\n  while locating InternalServletModule$BackwardsCompatibleServletContextProvider\n  at ProjectQoSFilter.\u003cinit\u003e(ProjectQoSFilter.java:147)\n      \\_ for 4th parameter context\n  at ProjectQoSFilter.class(ProjectQoSFilter.java:68)\n  while locating ProjectQoSFilter\n\nLearn more:\n  https://github.com/google/guice/wiki/NULL_INJECTED_INTO_NON_NULLABLE\n\n1 error\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nFull classname legend:\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nInternalServletModule:                                           \"com.google.inject.servlet.InternalServletModule\"\nInternalServletModule$BackwardsCompatibleServletContextProvider: \"com.google.inject.servlet.InternalServletModule$BackwardsCompatibleServletContextProvider\"\nProjectQoSFilter:                                                \"com.google.gerrit.pgm.http.jetty.ProjectQoSFilter\"\nRequestContextFilter$1:                                          \"com.google.gerrit.httpd.RequestContextFilter$1\"\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nEnd of classname legend:\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\n\tat com.google.inject.internal.InternalProvisionException.toProvisionException(InternalProvisionException.java:251)\n\tat com.google.inject.internal.InjectorImpl$1.get(InjectorImpl.java:1151)\n\tat com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1181)\n\tat com.google.inject.servlet.FilterDefinition.init(FilterDefinition.java:100)\n\tat com.google.inject.servlet.ManagedFilterPipeline.initPipeline(ManagedFilterPipeline.java:98)\n\tat com.google.inject.servlet.GuiceFilter.init(GuiceFilter.java:232)\n\tat org.eclipse.jetty.servlet.FilterHolder.initialize(FilterHolder.java:140)\n\tat org.eclipse.jetty.servlet.ServletHandler.lambda$initialize$0(ServletHandler.java:750)\n\tat java.base/java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:992)\n\tat java.base/java.util.stream.Streams$ConcatSpliterator.forEachRemaining(Streams.java:734)\n\tat java.base/java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:762)\n\tat org.eclipse.jetty.servlet.ServletHandler.initialize(ServletHandler.java:774)\n\tat org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:379)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:916)\n\tat org.eclipse.jetty.servlet.ServletContextHandler.doStart(ServletContextHandler.java:288)\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:73)\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.start(ContainerLifeCycle.java:169)\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStart(ContainerLifeCycle.java:117)\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:97)\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:73)\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.start(ContainerLifeCycle.java:169)\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStart(ContainerLifeCycle.java:110)\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:97)\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:73)\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.start(ContainerLifeCycle.java:169)\n\tat org.eclipse.jetty.server.Server.start(Server.java:423)\n\tat org.eclipse.jetty.util.component.ContainerLifeCycle.doStart(ContainerLifeCycle.java:110)\n\tat org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:97)\n\tat org.eclipse.jetty.server.Server.doStart(Server.java:387)\n\tat org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:73)\n\tat com.google.gerrit.pgm.http.jetty.JettyServer$Lifecycle.start(JettyServer.java:97)\n\t... 12 more\n```",
      "parentUuid": "1abcea64_2dc7e1a6",
      "revId": "2127e7067c6c2d8377f76af9cdd4349aa5b59d13",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5bef357f_1a5c455e",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/filter/HealthCheckStatusFilter.java",
        "patchSetId": 2
      },
      "lineNbr": 52,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2025-01-15T09:20:49Z",
      "side": 1,
      "message": "Done. However, I was unable to test it against multiple configured listenUrls, since I get errors when configuring that. I tried back until 2.16. I believe that feature is broken for a long time.",
      "parentUuid": "ba41be5b_77257a15",
      "revId": "2127e7067c6c2d8377f76af9cdd4349aa5b59d13",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}