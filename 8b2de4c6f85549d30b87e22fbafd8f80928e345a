{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "12e31993_4c3acd8a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-28T20:51:38Z",
      "side": 1,
      "message": "Actually, some blocked threads in a specific thread pool could be more important for the overall healthiness of Gerrit.\n\nExample:\nGerrit is running 100 threads, but 20 of them are the SSH thread pool. All the SSH threads are blocked but they are only 20% of the total, so the healthcheck does not fire.\n\nWhat about adding a prefix for the threads so that the check is going to consider only those?\n\nFor instnace if prefix is \"SSH-Interactive-Worker\", then if 50% of the threads in that pool are blocked, then the overall instance is flagged as unhealthy.",
      "range": {
        "startLine": 11,
        "startChar": 28,
        "endLine": 11,
        "endChar": 60
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d703ba43_797b5182",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-04-28T20:58:38Z",
      "side": 1,
      "message": "ok so we would have the first candidate :D\nThinking out loud I can imagine that one could specify either one or more prefixes (or better patterns/regexps?) with the corresponding threshold (or single threshold for all). Would that make sense or it would be a bit overengineered?",
      "parentUuid": "12e31993_4c3acd8a",
      "range": {
        "startLine": 11,
        "startChar": 28,
        "endLine": 11,
        "endChar": 60
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "383d7d4e_e10dbecc",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-04-28T21:00:19Z",
      "side": 1,
      "message": "\u003e ok so we would have the first candidate :D\n\u003e Thinking out loud I can imagine that one could specify either one or more prefixes (or better patterns/regexps?) with the corresponding threshold (or single threshold for all). Would that make sense or it would be a bit overengineered?\n\nI believe you are right and it will make sense to have multiple definitions.\nThe prefix is enough to identify the thread pool and is quicker to evaluate than regex.",
      "parentUuid": "d703ba43_797b5182",
      "range": {
        "startLine": 11,
        "startChar": 28,
        "endLine": 11,
        "endChar": 60
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "362221cc_34eda82d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "Thanks for the input. I will either address or read more about the cases that I\u0027m not sure ;)",
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5df947ad_4ce9bb01",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/HealthCheckConfig.java",
        "patchSetId": 2
      },
      "lineNbr": 119,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2021-04-29T12:08:32Z",
      "side": 1,
      "message": "Is this part of this change?",
      "range": {
        "startLine": 116,
        "startChar": 4,
        "endLine": 119,
        "endChar": 84
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a931f715_156ba977",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/HealthCheckConfig.java",
        "patchSetId": 2
      },
      "lineNbr": 119,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "It is, otherwise it takes the default from the ACTIVE_WORKERS_THRESHOLD_DEFAULT which IMHO doesn\u0027t make sense to wire... I will probably rework it anyway as we there are multiple thresholds to be configured and it would have to look different ;)",
      "parentUuid": "5df947ad_4ce9bb01",
      "range": {
        "startLine": 116,
        "startChar": 4,
        "endLine": 119,
        "endChar": 84
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e6bdb54_d52bf6b1",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2021-04-29T12:08:32Z",
      "side": 1,
      "message": "What about a more explicit \"BlockedThreadsCheck\" ?",
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ce00a29_b43274ec",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-05-02T20:12:55Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "2e6bdb54_d52bf6b1",
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f287a506_813460bf",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "2ce00a29_b43274ec",
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "817fd609_e086e4d7",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-05-02T20:12:55Z",
      "side": 1,
      "message": "Should this be a @Singleton?",
      "range": {
        "startLine": 33,
        "startChar": 0,
        "endLine": 33,
        "endChar": 25
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "49d40f05_eb230999",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "Good question :) I can\u0027t see the others to be singletons either... AFAICT they are all referenced in the GlobalCheck which is a Singleton which is probably enough (but I will check it later and elaborate ;))",
      "parentUuid": "817fd609_e086e4d7",
      "range": {
        "startLine": 33,
        "startChar": 0,
        "endLine": 33,
        "endChar": 25
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52e093b0_17ddcabc",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 35,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2021-04-29T12:08:32Z",
      "side": 1,
      "message": "Similarly to my previous comment, maybe a more explicit naming: DEFAULT_BLOCKED_THREADS_THRESHOLD",
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "56ac0e8f_149cbcea",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 35,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "52e093b0_17ddcabc",
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "186e00f9_9c21b5c5",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-05-02T20:12:55Z",
      "side": 1,
      "message": "In what case can dumpAllThreads return null?\nIs it not guaranteed to always return ThreadInfo[]?",
      "range": {
        "startLine": 60,
        "startChar": 11,
        "endLine": 60,
        "endChar": 31
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7e4fb86_9a82fc8c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-05-02T20:12:55Z",
      "side": 1,
      "message": "threadInfos?",
      "range": {
        "startLine": 64,
        "startChar": 12,
        "endLine": 64,
        "endChar": 17
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b9151b49_0c245a00",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 64,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "e7e4fb86_9a82fc8c",
      "range": {
        "startLine": 64,
        "startChar": 12,
        "endLine": 64,
        "endChar": 17
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ec11eeca_487e89ac",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 75,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-05-02T20:12:55Z",
      "side": 1,
      "message": "I am not sure I understand this: can we get information about BLOCKED threads, but only if _at least_ one of SynchronizerUsage or ObjectMonitorUsage is supported, regardless of which one.\n\nIs this correct?",
      "range": {
        "startLine": 75,
        "startChar": 2,
        "endLine": 75,
        "endChar": 94
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eda9f95e_1a30b9e2",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/healthcheck/check/BlockedCheck.java",
        "patchSetId": 2
      },
      "lineNbr": 75,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "That was my impression from comment from Matthias to the Gerrit core change [1]. I\u0027m going to read more about it and elaborate ;)\n\n[1] https://gerrit-review.googlesource.com/c/gerrit/+/304012/4/java/com/google/gerrit/metrics/proc/ProcMetricModule.java#323",
      "parentUuid": "ec11eeca_487e89ac",
      "range": {
        "startLine": 75,
        "startChar": 2,
        "endLine": 75,
        "endChar": 94
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bd41960f_1e141a44",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/healthcheck/BlockedCheckTest.java",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-05-02T20:12:55Z",
      "side": 1,
      "message": "Consider also adding some IT tests in HealthCheckIT",
      "range": {
        "startLine": 39,
        "startChar": 0,
        "endLine": 39,
        "endChar": 31
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b142c08d_ffb17e18",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/healthcheck/BlockedCheckTest.java",
        "patchSetId": 2
      },
      "lineNbr": 39,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "bd41960f_1e141a44",
      "range": {
        "startLine": 39,
        "startChar": 0,
        "endLine": 39,
        "endChar": 31
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e0697d4e_5dffbc23",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/healthcheck/BlockedCheckTest.java",
        "patchSetId": 2
      },
      "lineNbr": 56,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2021-04-29T12:08:32Z",
      "side": 1,
      "message": "Do we also need to cover the other cases?\n\n    beanMock.isSynchronizerUsageSupported()  \u003d\u003e true\n    beanMock.isObjectMonitorUsageSupported() \u003d\u003e true\n\n    beanMock.isSynchronizerUsageSupported()  \u003d\u003e false\n    beanMock.isObjectMonitorUsageSupported() \u003d\u003e true\n\n    beanMock.isSynchronizerUsageSupported()  \u003d\u003e true\n    beanMock.isObjectMonitorUsageSupported() \u003d\u003e false",
      "range": {
        "startLine": 55,
        "startChar": 1,
        "endLine": 56,
        "endChar": 68
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0199c3f8_755f0b8b",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/healthcheck/BlockedCheckTest.java",
        "patchSetId": 2
      },
      "lineNbr": 56,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "In all other these cases it should be enabled. But sure I can add those scenarios.",
      "parentUuid": "e0697d4e_5dffbc23",
      "range": {
        "startLine": 55,
        "startChar": 1,
        "endLine": 56,
        "endChar": 68
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e520fd76_7eb519a0",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/healthcheck/BlockedCheckTest.java",
        "patchSetId": 2
      },
      "lineNbr": 68,
      "author": {
        "id": 1054778
      },
      "writtenOn": "2021-04-29T12:08:32Z",
      "side": 1,
      "message": "It might be more readable extracting those in constants, otherwise you will have to read the signature of the helper function every time. WDYT?\n\n    int runningThreads \u003d 1;\n    int blockedThreads \u003d 0;\n    mockThreadsAndCheckResult(runningThreads, blockedThreads, Result.PASSED);",
      "range": {
        "startLine": 68,
        "startChar": 30,
        "endLine": 68,
        "endChar": 35
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8582cde4_a4fa2030",
        "filename": "src/test/java/com/googlesource/gerrit/plugins/healthcheck/BlockedCheckTest.java",
        "patchSetId": 2
      },
      "lineNbr": 68,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2021-05-03T08:11:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "e520fd76_7eb519a0",
      "range": {
        "startLine": 68,
        "startChar": 30,
        "endLine": 68,
        "endChar": 35
      },
      "revId": "8b2de4c6f85549d30b87e22fbafd8f80928e345a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}